<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Interactive Galvanic Cell (Voltaic Cell) Simulator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root { 
            --bg-color: #020617; 
            --card-color: rgba(15, 23, 42, 0.7);
            --border-color: #1e293b; 
            --text-light: #e2e8f0;
            --accent-color: #10b981; /* Emerald */
        }
        body { background-color: var(--bg-color); color: var(--text-light); font-family: 'Inter', sans-serif; }
        .glass-card { background: var(--card-color); backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px); border: 1px solid var(--border-color); }
        input[type=range] { -webkit-appearance: none; appearance: none; width: 100%; height: 6px; background: var(--border-color); border-radius: 99px; outline: none; transition: background-color 0.2s ease; }
        input[type=range]:hover { background: #334155; }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none; appearance: none; width: 20px; height: 20px;
            border-radius: 50%; background: var(--accent-color); border: 2px solid var(--text-light);
            cursor: pointer; transition: transform 0.1s ease-in-out, box-shadow 0.2s ease;
            box-shadow: 0 0 0 2px rgba(16, 185, 129, 0.2);
        }
        input[type=range]::-webkit-slider-thumb:hover { transform: scale(1.1); box-shadow: 0 0 0 4px rgba(16, 185, 129, 0.4); }
        .sim-button {
            background: var(--accent-color); color: var(--bg-color);
            transition: all .2s ease; box-shadow: 0 4px 10px rgba(0,0,0,.3);
        }
        .sim-button:hover { background: #34d399; transform: translateY(-2px); box-shadow: 0 6px 15px rgba(0,0,0,.4); }
        select {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%2364748b' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
            background-position: right 0.5rem center; background-repeat: no-repeat; background-size: 1.5em 1.5em;
            padding-right: 2.5rem; -webkit-appearance: none; -moz-appearance: none; appearance: none;
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
</head>
<body class="min-h-screen p-4 sm:p-6 lg:p-8">
    <div class="container mx-auto max-w-7xl">
        <header class="mb-6 text-center">
            <h1 class="text-3xl md:text-4xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-emerald-400 to-green-400">Galvanic Cell Simulator</h1>
            <p class="mt-2 text-slate-400 max-w-2xl mx-auto">Build a voltaic cell, observe electron and ion flow, and see how concentration affects voltage via the Nernst equation.</p>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <div class="glass-card shadow-2xl p-2 rounded-2xl lg:col-span-2">
                <canvas id="simulation-canvas" class="w-full h-[500px] md:h-[600px] rounded-lg"></canvas>
            </div>
            
            <div class="space-y-6">
                 <h2 class="text-2xl font-bold text-center text-slate-300">Cell Configuration</h2>
                <div class="glass-card shadow-lg p-5 rounded-2xl space-y-4">
                    <h3 class="font-bold text-lg text-emerald-300 flex items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-2"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"></path><polyline points="14 2 14 8 20 8"></polyline><path d="m10 10.5 4 4"></path><path d="m10 14.5 4-4"></path></svg>
                        Half-Cells
                    </h3>
                    <div class="text-sm space-y-4 pt-2">
                        <div>
                            <label for="anode-metal" class="font-medium text-slate-300">Anode (Oxidation)</label>
                            <select id="anode-metal" class="w-full mt-1 bg-slate-800 border border-slate-600 rounded-lg px-3 py-2 text-white">
                                <option value="Zn">Zinc (Zn)</option>
                                <option value="Fe">Iron (Fe)</option>
                                <option value="Pb">Lead (Pb)</option>
                                <option value="Cu">Copper (Cu)</option>
                            </select>
                        </div>
                        <div>
                            <label for="anode-conc" class="font-medium text-slate-300 flex justify-between">Anode [Ion] Conc.: <span id="anode-conc-val">1.0 M</span></label>
                            <input type="range" id="anode-conc" min="0.01" max="2.0" step="0.01" value="1.0">
                        </div>
                         <div class="pt-4">
                            <label for="cathode-metal" class="font-medium text-slate-300">Cathode (Reduction)</label>
                            <select id="cathode-metal" class="w-full mt-1 bg-slate-800 border border-slate-600 rounded-lg px-3 py-2 text-white">
                                <option value="Cu">Copper (Cu)</option>
                                <option value="Ag">Silver (Ag)</option>
                                <option value="Au">Gold (Au)</option>
                            </select>
                        </div>
                         <div>
                            <label for="cathode-conc" class="font-medium text-slate-300 flex justify-between">Cathode [Ion] Conc.: <span id="cathode-conc-val">1.0 M</span></label>
                            <input type="range" id="cathode-conc" min="0.01" max="2.0" step="0.01" value="1.0">
                        </div>
                    </div>
                </div>

                <div class="glass-card shadow-lg p-5 rounded-2xl space-y-4">
                     <h3 class="font-bold text-lg text-emerald-300 flex items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-2"><path d="M3 3v18h18"></path><path d="m19 9-5 5-4-4-3 3"></path></svg>
                        Cell Analysis
                    </h3>
                     <div class="text-sm pt-2 space-y-1 font-mono bg-slate-900/50 p-3 rounded-md">
                        <p id="anode-reaction"></p>
                        <p id="cathode-reaction"></p>
                     </div>
                     <div class="text-sm pt-2 space-y-2">
                        <p class="flex justify-between text-slate-400">Standard E°cell: <span id="e0-val" class="font-mono text-white">0.00 V</span></p>
                        <p class="flex justify-between text-slate-400">Nernst Ecell: <span id="e-val" class="font-mono text-2xl font-semibold text-white">0.00 V</span></p>
                    </div>
                    <div class="flex gap-4 pt-4">
                        <button id="connect-btn" class="w-full sim-button font-bold py-3 px-4 rounded-lg">Connect Cell</button>
                        <button id="reset-btn" class="w-full bg-slate-600 text-white font-semibold py-3 px-4 rounded-lg hover:bg-slate-700">Reset</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

<script>
(function() {
    const canvas = document.getElementById('simulation-canvas');
    const ctx = canvas.getContext('2d');
    
    const inputs = {
        anode: document.getElementById('anode-metal'),
        cathode: document.getElementById('cathode-metal'),
        anodeConc: document.getElementById('anode-conc'),
        cathodeConc: document.getElementById('cathode-conc'),
    };
    const valueSpans = {
        anodeConc: document.getElementById('anode-conc-val'),
        cathodeConc: document.getElementById('cathode-conc-val'),
    };
     const analysis = {
        anodeRxn: document.getElementById('anode-reaction'),
        cathodeRxn: document.getElementById('cathode-reaction'),
        e0: document.getElementById('e0-val'),
        e: document.getElementById('e-val'),
    };
    
    const connectBtn = document.getElementById('connect-btn');
    const resetBtn = document.getElementById('reset-btn');

    const E0_POTENTIALS = {
        Zn: { E0: -0.76, n: 2, ion: 'Zn²⁺' }, Fe: { E0: -0.44, n: 2, ion: 'Fe²⁺' },
        Pb: { E0: -0.13, n: 2, ion: 'Pb²⁺' }, Cu: { E0: 0.34, n: 2, ion: 'Cu²⁺' },
        Ag: { E0: 0.80, n: 1, ion: 'Ag⁺' }, Au: { E0: 1.50, n: 3, ion: 'Au³⁺' },
    };

    let state = {};
    let sim = { running: false, particles: [], anodeMass: 100, cathodeMass: 100 };
    let rafId = null;

    function resizeCanvas() {
        const simRect = canvas.parentElement.getBoundingClientRect();
        canvas.width = simRect.width;
        canvas.height = simRect.height > 100 ? simRect.height : 600;
        draw();
    }

    function resetSimulation() {
        if(sim.running) toggleConnection();
        sim = { running: false, particles: [], anodeMass: 100, cathodeMass: 100 };
        updateStateFromInputs();
        draw();
    }
    
    function updateStateFromInputs() {
        state.anode = inputs.anode.value;
        state.cathode = inputs.cathode.value;
        state.anodeConc = parseFloat(inputs.anodeConc.value);
        state.cathodeConc = parseFloat(inputs.cathodeConc.value);
        
        valueSpans.anodeConc.textContent = `${state.anodeConc.toFixed(2)} M`;
        valueSpans.cathodeConc.textContent = `${state.cathodeConc.toFixed(2)} M`;
        
        updateAnalysis();
    }
    
    function calculatePotentials() {
        const anodeInfo = E0_POTENTIALS[state.anode];
        const cathodeInfo = E0_POTENTIALS[state.cathode];

        const E0_anode = anodeInfo.E0;
        const E0_cathode = cathodeInfo.E0;
        const E0_cell = E0_cathode - E0_anode;
        
        if (E0_cell < 0) return { E0_cell, E_cell: 0, n: 0, Q: 0 }; // Spontaneity check

        const n = anodeInfo.n * cathodeInfo.n; // LCM for electrons
        const R = 8.314, T = 298.15, F = 96485;
        const Q = Math.pow(state.anodeConc, cathodeInfo.n) / Math.pow(state.cathodeConc, anodeInfo.n);
        
        const E_cell = E0_cell - (R * T / (n * F)) * Math.log(Q);
        return { E0_cell, E_cell, n, Q };
    }
    
    function updateAnalysis() {
        const { E0_cell, E_cell } = calculatePotentials();
        const anodeInfo = E0_POTENTIALS[state.anode];
        const cathodeInfo = E0_POTENTIALS[state.cathode];

        if (E0_cell < 0) {
            analysis.anodeRxn.textContent = "Invalid Pair: E°cell < 0";
            analysis.cathodeRxn.textContent = "Select a more active anode.";
            analysis.e0.textContent = `---`;
            analysis.e.textContent = `---`;
            connectBtn.disabled = true;
            return;
        }
        connectBtn.disabled = false;
        
        analysis.anodeRxn.innerHTML = `Anode: ${state.anode} → ${anodeInfo.ion} + ${anodeInfo.n}e⁻`;
        analysis.cathodeRxn.innerHTML = `Cathode: ${cathodeInfo.ion} + ${cathodeInfo.n}e⁻ → ${state.cathode}`;
        analysis.e0.textContent = `${E0_cell.toFixed(2)} V`;
        analysis.e.textContent = `${E_cell.toFixed(2)} V`;
    }

    function physicsStep() {
        // Electron flow
        if (Math.random() < 0.5) {
             sim.particles.push({ type: 'electron', x: canvas.width * 0.25, y: 100, vx: 2, vy: 0 });
        }
        // Ion flow
        if (Math.random() < 0.2) {
            sim.particles.push({ type: 'cation', x: canvas.width/2, y: 250, vx: -1, vy: 0}); // Cations to cathode
            sim.particles.push({ type: 'anion', x: canvas.width/2, y: 250, vx: 1, vy: 0}); // Anions to anode
        }

        sim.particles.forEach((p,i) => {
            p.x += p.vx; p.y += p.vy;
            if(p.x < 0 || p.x > canvas.width) sim.particles.splice(i,1);
        });

        // Electrode mass change
        sim.anodeMass = Math.max(80, sim.anodeMass - 0.01);
        sim.cathodeMass = Math.min(120, sim.cathodeMass + 0.01);
    }

    function loop() {
        if (!sim.running) return;
        physicsStep();
        draw();
        rafId = requestAnimationFrame(loop);
    }

    function draw() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        drawBeakers();
        drawCircuit();
        if(sim.running) sim.particles.forEach(drawParticle);
    }
    
    function drawBeakers() {
        const cW = canvas.width, cH = canvas.height;
        // Anode Beaker
        drawBeaker(cW * 0.25, 'Anode', state.anode, sim.anodeMass);
        // Cathode Beaker
        drawBeaker(cW * 0.75, 'Cathode', state.cathode, sim.cathodeMass);
    }
    
    function drawBeaker(x, label, metal, mass) {
        const y = 300, w = 200, h = 250;
        ctx.strokeStyle = '#94a3b8'; ctx.lineWidth = 2;
        ctx.beginPath();
        ctx.moveTo(x - w/2, y); ctx.lineTo(x-w/2, y+h);
        ctx.lineTo(x+w/2, y+h); ctx.lineTo(x+w/2, y);
        ctx.stroke();

        ctx.fillStyle = 'rgba(56, 189, 248, 0.2)';
        ctx.fillRect(x - w/2, y + 80, w, h-80);
        
        // Electrode
        const electrodeW = 20 * (mass / 100);
        ctx.fillStyle = '#94a3b8';
        ctx.fillRect(x - electrodeW/2, y+20, electrodeW, h-50);

        ctx.fillStyle = '#e2e8f0'; ctx.font = '12px Inter'; ctx.textAlign = 'center';
        ctx.fillText(`${label} (${metal})`, x, y-10);
    }

    function drawCircuit() {
        const cW = canvas.width, cH = canvas.height;
        const anodeX = cW * 0.25, cathodeX = cW * 0.75, wireY = 100;

        // Wires and Voltmeter
        ctx.strokeStyle = '#64748b'; ctx.lineWidth = 3;
        ctx.beginPath();
        ctx.moveTo(anodeX, 320); ctx.lineTo(anodeX, wireY);
        ctx.lineTo(cathodeX, wireY); ctx.lineTo(cathodeX, 320);
        ctx.stroke();

        ctx.fillStyle = '#1e293b';
        ctx.beginPath(); ctx.arc(cW/2, wireY, 40, 0, Math.PI*2); ctx.fill();
        ctx.stroke();
        
        const {E_cell} = calculatePotentials();
        ctx.fillStyle = '#e2e8f0'; ctx.font = 'bold 18px Inter';
        ctx.fillText(`${E_cell.toFixed(2)}V`, cW/2, wireY+6);

        // Salt Bridge
        ctx.strokeStyle = '#94a3b8';
        ctx.beginPath();
        ctx.moveTo(anodeX + 80, 300);
        ctx.bezierCurveTo(anodeX + 120, 220, cathodeX - 120, 220, cathodeX - 80, 300);
        ctx.stroke();
    }
    
    function drawParticle(p) {
        if(p.type === 'electron') {
            ctx.fillStyle = '#facc15';
            ctx.beginPath(); ctx.arc(p.x, p.y, 3, 0, Math.PI * 2); ctx.fill();
        } else {
            ctx.fillStyle = p.type === 'cation' ? '#38bdf8' : '#fb923c';
            ctx.beginPath(); ctx.arc(p.x, p.y, 4, 0, Math.PI * 2); ctx.fill();
        }
    }
    
    function toggleConnection() {
        sim.running = !sim.running;
        if (sim.running) {
            connectBtn.textContent = 'Disconnect Cell';
            connectBtn.classList.remove('sim-button');
            connectBtn.classList.add('bg-red-500', 'text-white');
            loop();
        } else {
            connectBtn.textContent = 'Connect Cell';
            connectBtn.classList.add('sim-button');
            connectBtn.classList.remove('bg-red-500', 'text-white');
            if(rafId) cancelAnimationFrame(rafId);
            rafId = null;
        }
    }

    // --- Event Handlers ---
    Object.values(inputs).forEach(input => input.addEventListener('input', () => {
        if(!sim.running) {
             updateStateFromInputs();
             draw();
        }
    }));
    connectBtn.addEventListener('click', toggleConnection);
    resetBtn.addEventListener('click', resetSimulation);
    window.addEventListener('resize', resizeCanvas);
    
    resetSimulation();
})();
</script>
</body>
</html>

