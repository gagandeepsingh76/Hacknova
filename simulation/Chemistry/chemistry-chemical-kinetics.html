<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Interactive Chemical Kinetics Simulator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root { 
            --bg-color: #020617; 
            --card-color: rgba(15, 23, 42, 0.7);
            --border-color: #1e293b; 
            --text-light: #e2e8f0;
            --accent-color: #10b981; /* Emerald */
            --reactant-a-color: 'rgba(59, 130, 246, 0.9)';
            --reactant-b-color: 'rgba(236, 72, 153, 0.9)';
            --product-c-color: 'rgba(234, 179, 8, 0.9)';
        }
        body { background-color: var(--bg-color); color: var(--text-light); font-family: 'Inter', sans-serif; }
        .glass-card { background: var(--card-color); backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px); border: 1px solid var(--border-color); }
        input[type=range] { -webkit-appearance: none; appearance: none; width: 100%; height: 6px; background: var(--border-color); border-radius: 99px; outline: none; transition: background-color 0.2s ease; }
        input[type=range]:hover { background: #334155; }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none; appearance: none; width: 20px; height: 20px;
            border-radius: 50%; background: var(--accent-color); border: 2px solid var(--text-light);
            cursor: pointer; transition: transform 0.1s ease-in-out, box-shadow 0.2s ease;
            box-shadow: 0 0 0 2px rgba(16, 185, 129, 0.2);
        }
        input[type=range]::-webkit-slider-thumb:hover { transform: scale(1.1); box-shadow: 0 0 0 4px rgba(16, 185, 129, 0.4); }
        .sim-button {
            background-color: var(--border-color);
            border: 1px solid #334155;
            transition: all 0.2s ease;
        }
        .sim-button:hover {
            background-color: #334155;
            border-color: var(--accent-color);
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
</head>
<body class="min-h-screen p-4 sm:p-6 lg:p-8">
    <div class="container mx-auto max-w-7xl">
        <header class="mb-6 text-center">
            <h1 class="text-3xl md:text-4xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-emerald-400 to-green-400">Chemical Kinetics Simulator</h1>
            <p class="mt-2 text-slate-400 max-w-2xl mx-auto">Observe how temperature, concentration, and activation energy affect reaction rates at a molecular level.</p>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <div class="glass-card shadow-2xl p-2 rounded-2xl lg:col-span-2">
                <canvas id="simulation-canvas" class="w-full h-[500px] md:h-[600px] rounded-lg"></canvas>
            </div>
            
            <div class="space-y-6">
                 <h2 class="text-2xl font-bold text-center text-slate-300">Reaction Controls</h2>
                <div class="glass-card shadow-lg p-5 rounded-2xl space-y-4">
                    <h3 class="font-bold text-lg text-emerald-300 flex items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-2"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"></path><polyline points="14 2 14 8 20 8"></polyline><path d="M12 18v-6"></path><path d="M9 15h6"></path></svg>
                        Conditions
                    </h3>
                    <p class="text-center font-mono text-lg text-slate-300 pt-2">
                        <span style="color: var(--reactant-a-color)">A</span> + <span style="color: var(--reactant-b-color)">B</span> â†’ <span style="color: var(--product-c-color)">C</span>
                    </p>
                    <div class="text-sm space-y-4 pt-2">
                        <div>
                            <label for="temperature" class="font-medium text-slate-300 flex justify-between">Temperature: <span id="temp-val">300 K</span></label>
                            <input type="range" id="temperature" min="250" max="400" step="1" value="300">
                        </div>
                        <div>
                            <label for="activation-energy" class="font-medium text-slate-300 flex justify-between">Activation Energy (Ea): <span id="ea-val">50</span></label>
                            <input type="range" id="activation-energy" min="20" max="100" step="1" value="50">
                        </div>
                        <div class="grid grid-cols-2 gap-4 !mt-6">
                           <button id="add-a" class="sim-button py-2 rounded-lg">+ Add Reactant A</button>
                           <button id="add-b" class="sim-button py-2 rounded-lg">+ Add Reactant B</button>
                        </div>
                    </div>
                </div>

                <div class="glass-card shadow-lg p-5 rounded-2xl space-y-4">
                     <h3 class="font-bold text-lg text-emerald-300 flex items-center">
                       <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-2"><path d="M3 3v18h18"></path><path d="m19 9-5 5-4-4-3 3"></path></svg>
                        Live Concentration Plot
                    </h3>
                    <canvas id="graph-canvas" class="w-full h-40 mt-2 rounded-lg bg-slate-900/50 border border-slate-700"></canvas>
                    <div class="flex gap-4 pt-2">
                        <button id="play-pause-btn" class="w-full sim-button font-bold py-3 px-4 rounded-lg flex items-center justify-center bg-emerald-500 text-slate-900 hover:bg-emerald-400">
                           <svg id="play-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" class="mr-2"><path d="M8 5v14l11-7z"></path></svg>
                           <svg id="pause-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" class="mr-2 hidden"><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"></path></svg>
                            <span id="play-pause-text">Start</span>
                        </button>
                        <button id="reset-btn" class="w-full bg-slate-600 text-white font-semibold py-3 px-4 rounded-lg hover:bg-slate-700">Reset</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

<script>
(function() {
    const simCanvas = document.getElementById('simulation-canvas');
    const simCtx = simCanvas.getContext('2d');
    const graphCanvas = document.getElementById('graph-canvas');
    const graphCtx = graphCanvas.getContext('2d');
    
    const inputs = {
        temperature: document.getElementById('temperature'),
        Ea: document.getElementById('activation-energy'),
    };
    const valueSpans = {
        temperature: document.getElementById('temp-val'),
        Ea: document.getElementById('ea-val'),
    };
    
    const addA_btn = document.getElementById('add-a');
    const addB_btn = document.getElementById('add-b');
    const playPauseBtn = document.getElementById('play-pause-btn');
    const playPauseText = document.getElementById('play-pause-text');
    const playIcon = document.getElementById('play-icon');
    const pauseIcon = document.getElementById('pause-icon');
    const resetBtn = document.getElementById('reset-btn');

    let state = { T: 300, Ea: 50 };
    let sim = { particles: [], running: false, history: [], time: 0 };
    let rafId = null;
    const R = 8.314;

    function resizeCanvas() {
        const simRect = simCanvas.parentElement.getBoundingClientRect();
        simCanvas.width = simRect.width;
        simCanvas.height = simRect.height > 100 ? simRect.height : 600;
        
        const graphRect = graphCanvas.parentElement.getBoundingClientRect();
        graphCanvas.width = graphRect.width; 
        graphCanvas.height = 160;
        
        draw();
    }

    function resetSimulation() {
        if (sim.running) togglePlayPause();
        sim.particles = [];
        for(let i=0; i<50; i++) sim.particles.push(createAgent('A'));
        for(let i=0; i<50; i++) sim.particles.push(createAgent('B'));
        sim.history = [];
        sim.time = 0;
        updateStateFromInputs();
        draw();
    }
    
    function createAgent(type, x, y) {
        return {
            x: x || Math.random() * simCanvas.width,
            y: y || Math.random() * simCanvas.height,
            vx: (Math.random() - 0.5) * 4,
            vy: (Math.random() - 0.5) * 4,
            type: type,
        };
    }

    function updateStateFromInputs() {
        state.T = parseFloat(inputs.temperature.value);
        state.Ea = parseFloat(inputs.Ea.value);
        
        valueSpans.temperature.textContent = `${state.T.toFixed(0)} K`;
        valueSpans.Ea.textContent = state.Ea.toFixed(0);
    }
    
    function physicsStep() {
        const speed = Math.sqrt(state.T / 273);

        for (let i = sim.particles.length - 1; i >= 0; i--) {
            const p1 = sim.particles[i];
            moveAgent(p1, speed);

            for (let j = i - 1; j >= 0; j--) {
                const p2 = sim.particles[j];
                const dist = Math.hypot(p1.x - p2.x, p1.y - p2.y);

                if (dist < 12 && p1.type !== p2.type) {
                    const collisionEnergy = 0.5 * (p1.vx - p2.vx)**2 + 0.5 * (p1.vy - p2.vy)**2;
                    if (collisionEnergy > state.Ea) {
                        const newX = (p1.x + p2.x) / 2;
                        const newY = (p1.y + p2.y) / 2;
                        sim.particles.splice(i, 1);
                        sim.particles.splice(j, 1);
                        sim.particles.push(createAgent('C', newX, newY));
                        i--; // Adjust index after splice
                        break;
                    }
                }
            }
        }
        
        sim.time += 0.1;
        if (sim.history.length === 0 || sim.time - sim.history[sim.history.length - 1].t > 0.5) {
            const countA = sim.particles.filter(p=>p.type==='A').length;
            const countB = sim.particles.filter(p=>p.type==='B').length;
            const countC = sim.particles.filter(p=>p.type==='C').length;
            sim.history.push({ t: sim.time, A: countA, B: countB, C: countC });
            if (sim.history.length > 200) sim.history.shift();
        }
    }
    
    function moveAgent(agent, speed) {
        agent.x += agent.vx * speed;
        agent.y += agent.vy * speed;
        if (agent.x < 0 || agent.x > simCanvas.width) agent.vx *= -1;
        if (agent.y < 0 || agent.y > simCanvas.height) agent.vy *= -1;
    }

    function loop() {
        if (!sim.running) return;
        physicsStep();
        draw();
        rafId = requestAnimationFrame(loop);
    }

    function draw() {
        simCtx.clearRect(0, 0, simCanvas.width, simCanvas.height);
        drawVessel();
        sim.particles.forEach(p => drawAgent(p));
        drawEnergyProfile();
        drawGraph();
    }
    
    function drawVessel() {
        simCtx.strokeStyle = '#334155';
        simCtx.lineWidth = 2;
        simCtx.strokeRect(0, 0, simCanvas.width, simCanvas.height);
    }
    
    function drawAgent(p) {
        simCtx.fillStyle = `var(--reactant-${p.type.toLowerCase()}-color)`;
        if (p.type === 'C') simCtx.fillStyle = 'var(--product-c-color)';
        simCtx.beginPath();
        simCtx.arc(p.x, p.y, 6, 0, Math.PI * 2);
        simCtx.fill();
    }
    
    function drawEnergyProfile() {
        const g = { x: simCanvas.width - 220, y: 20, w: 200, h: 100 };
        const pathX = t => g.x + t * g.w;
        const pathY = t => g.y + g.h - (Math.exp(-20 * (t - 0.5)**2) * state.Ea/100 * g.h + (1-t)*20);

        simCtx.strokeStyle = '#94a3b8';
        simCtx.beginPath();
        simCtx.moveTo(pathX(0), pathY(0));
        for(let t=0; t<=1; t+=0.05) ctx.lineTo(pathX(t), pathY(t));
        ctx.stroke();
    }

    function drawGraph() {
        graphCtx.clearRect(0, 0, graphCanvas.width, graphCanvas.height);
        if (sim.history.length < 2) return;
        
        const maxConc = 100;
        const tStart = sim.history[0].t;
        const tEnd = sim.history[sim.history.length - 1].t;
        const timeWindow = Math.max(20, tEnd - tStart);

        function plot(key, color) {
            graphCtx.strokeStyle = `var(--reactant-${key.toLowerCase()}-color)`;
            if(key==='C') graphCtx.strokeStyle = `var(--product-c-color)`;
            graphCtx.lineWidth = 2; graphCtx.beginPath();
            sim.history.forEach((p, i) => {
                const x = ((p.t - tStart) / timeWindow) * graphCanvas.width;
                const y = graphCanvas.height - (p[key] / maxConc) * graphCanvas.height;
                if (i === 0) graphCtx.moveTo(x, y); else graphCtx.lineTo(x, y);
            });
            graphCtx.stroke();
        }

        plot('A'); plot('B'); plot('C');
    }
    
    function togglePlayPause() {
        sim.running = !sim.running;
        if (sim.running) {
            playPauseText.textContent = 'Pause';
            playIcon.classList.add('hidden');
            pauseIcon.classList.remove('hidden');
            loop();
        } else {
            playPauseText.textContent = 'Start';
            playIcon.classList.remove('hidden');
            pauseIcon.classList.add('hidden');
            if(rafId) cancelAnimationFrame(rafId);
            rafId = null;
        }
    }

    // --- Event Handlers ---
    Object.values(inputs).forEach(input => input.addEventListener('input', updateStateFromInputs));
    addA_btn.addEventListener('click', () => { for(let i=0; i<10; i++) sim.particles.push(createAgent('A')); });
    addB_btn.addEventListener('click', () => { for(let i=0; i<10; i++) sim.particles.push(createAgent('B')); });
    playPauseBtn.addEventListener('click', togglePlayPause);
    resetBtn.addEventListener('click', resetSimulation);
    window.addEventListener('resize', resizeCanvas);
    
    resetSimulation();
})();
</script>
</body>
</html>

